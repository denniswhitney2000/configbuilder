<!DOCTYPE HTML>
<html>
<head>
    <title>DataRobot Config Builder v0.1</title>

    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        input:required:invalid, input:focus:invalid { background-position: right top; background-repeat: no-repeat; -moz-box-shadow: none; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAeVJREFUeNqkU01oE1EQ/mazSTdRmqSxLVSJVKU9RYoHD8WfHr16kh5EFA8eSy6hXrwUPBSKZ6E9V1CU4tGf0DZWDEQrGkhprRDbCvlpavan3ezu+LLSUnADLZnHwHvzmJlvvpkhZkY7IqFNaTuAfPhhP/8Uo87SGSaDsP27hgYM/lUpy6lHdqsAtM+BPfvqKp3ufYKwcgmWCug6oKmrrG3PoaqngWjdd/922hOBs5C/jJA6x7AiUt8VYVUAVQXXShfIqCYRMZO8/N1N+B8H1sOUwivpSUSVCJ2MAjtVwBAIdv+AQkHQqbOgc+fBvorjyQENDcch16/BtkQdAlC4E6jrYHGgGU18Io3gmhzJuwub6/fQJYNi/YBpCifhbDaAPXFvCBVxXbvfbNGFeN8DkjogWAd8DljV3KRutcEAeHMN/HXZ4p9bhncJHCyhNx52R0Kv/XNuQvYBnM+CP7xddXL5KaJw0TMAF8qjnMvegeK/SLHubhpKDKIrJDlvXoMX3y9xcSMZyBQ+tpyk5hzsa2Ns7LGdfWdbL6fZvHn92d7dgROH/730YBLtiZmEdGPkFnhX4kxmjVe2xgPfCtrRd6GHRtEh9zsL8xVe+pwSzj+OtwvletZZ/wLeKD71L+ZeHHWZ/gowABkp7AwwnEjFAAAAAElFTkSuQmCC); }
        /*
        input:required:valid { background-position: right top; background-repeat: no-repeat; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAepJREFUeNrEk79PFEEUx9/uDDd7v/AAQQnEQokmJCRGwc7/QeM/YGVxsZJQYI/EhCChICYmUJigNBSGzobQaI5SaYRw6imne0d2D/bYmZ3dGd+YQKEHYiyc5GUyb3Y+77vfeWNpreFfhvXfAWAAJtbKi7dff1rWK9vPHx3mThP2Iaipk5EzTg8Qmru38H7izmkFHAF4WH1R52654PR0Oamzj2dKxYt/Bbg1OPZuY3d9aU82VGem/5LtnJscLxWzfzRxaWNqWJP0XUadIbSzu5DuvUJpzq7sfYBKsP1GJeLB+PWpt8cCXm4+2+zLXx4guKiLXWA2Nc5ChOuacMEPv20FkT+dIawyenVi5VcAbcigWzXLeNiDRCdwId0LFm5IUMBIBgrp8wOEsFlfeCGm23/zoBZWn9a4C314A1nCoM1OAVccuGyCkPs/P+pIdVIOkG9pIh6YlyqCrwhRKD3GygK9PUBImIQQxRi4b2O+JcCLg8+e8NZiLVEygwCrWpYF0jQJziYU/ho2TUuCPTn8hHcQNuZy1/94sAMOzQHDeqaij7Cd8Dt8CatGhX3iWxgtFW/m29pnUjR7TSQcRCIAVW1FSr6KAVYdi+5Pj8yunviYHq7f72po3Y9dbi7CxzDO1+duzCXH9cEPAQYAhJELY/AqBtwAAAAASUVORK5CYII=); }
        */

        input[type="text"] { font-family: Arial, sans-serif; }
        input[type="email"] { width:159px; }
        input[type="port"] { width:50px; }
        span { font-size: .8em; clear:both; }
        
        .panel { border: 1px solid black; width: 99%; float: left; margin: 5px; padding: 5px; }        
        .question { padding: 5px 0 5px 10px; float:left; }
        .bundle { width: 23%; }
        .question label{ display: inline-block; text-align: right; margin-right:5px; font-weight:bold; }
        .question input { display: inline-block; }
        .createbutton { float:left; }
        .advancedbutton { float:right; }
        
        .hidden { display:none; }
        .showme { display:inline-block; }

        .dropped_config { width:92% !important; padding:5px !important; margin:5px !important; }

        .nodeconfig{ float:left; display:inline; width:200px; margin:10px; padding:10px;} 
    
        .defaultinput { width:150px !important; }
        .pathinput { width:300px !important; }

        #generatedconfig{ display:none; min-height:150px; height:650px; width:100%; overflow:scroll; }
        #advancedoptions { display: none; clear: both; width:99%; padding-top:10px; }

        #app_config{ border: 1px solid blue; }
        #data_config{ border: 1px solid green; }
        #modeling_config{ border: 1px solid red; }
        #prediction_config{ border: 1px solid orange; }

        #nodetype { width: 99%; min-height: 30px; margin: 5px; padding: 5px 0 5px 5px; }
        #node1, #node2, #node3, #node4 { border: 1px solid #000; background-color: #E1E9F0; width: 24%; height:300px; min-height: 20px; list-style-type: none; margin: 0; padding: 5px 0 0 0; float: left; margin-right: 10px; }
    </style>

    <script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="js/jquery.serializejson.js"></script>
    <script type="text/javascript" src="js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="js/js-yaml.min.js"></script>

    <script type="text/javascript">
    // Starting configuration type, changes based on blutton click
    var configtype="";

    // Services list based on configuration type
    var singleconfig = [ "nginx", "app", "appupload", "availabilitymonitor", "internalapi", "jobretryservice", "publicapi", "sentinel", "pngexport", "datasetsserviceapi", "provisioner", "resourceproxy", "queueproxy", "mmqueue", "edabroker", "idebroker", "ideworker", "securebroker", "edaworker", "secureworker", "datasetsserviceworker0", "datasetsservicequickworker0", "datasetsserviceworker1", "datasetsservicequickworker1", "mongo", "redis", "gluster", "rsyslog", "predictionoptimizationapi", "predictionoptimizationui", "logstash", "diagnostics" ];
    
    var services = new Object;
    services["app"]         = [ "nginx", "app", "appupload", "availabilitymonitor", "internalapi", "jobretryservice", "publicapi", "predictionapi", "pngexport", "datasetsserviceapi", "provisioner", "resourceproxy", "queueproxy", "mmqueue", "edabroker", "idebroker", "ideworker", "securebroker", "edaworker", "securebroker", "rsyslog", "predictionoptimizationapi", "predictionoptimizationui", "logstash", "diagnostics" ];
    services["data"]        = [ "mongo", "redis", "gluster" ];
    services["model"]       = [ "secureworker", "edaworker", "datasetsserviceworker0", "datasetsservicequickworker0", "datasetsserviceworker1", "datasetsservicequickworker1" ];
    services["prediction"]  = [ "dedicatedpredictionapi", "dedicatedpredictionnginx" ];

    services["dataslave"] = [ "mongo", "redis", "sentinel", "gluster" ];
    services["datanodemaster"] = [ "mongo", "sentinel", "gluster" ];
    services["modelonly"] = [ "secureworker" ];

    // List the types of nodes
    var types = ["app","data","prediction","model"];


    function flipit(where) {
        $("#" + where).toggle();
        var state = ( $("#" + where + " input").prop('disabled') == true ) ? false : true;
        $("#" + where + " input").prop('disabled', state);
        console.log("Flipped:> " + where + " inputs to disabled:" + state)
    }

    function flipitselect(where) {
        $("#" + where).toggle();
        var state = ( $("#" + where + " input").prop('disabled') == true ) ? false : true;
        $("#" + where + " input").prop('disabled', state);
        $("#" + where + " select").prop('disabled', state);
        console.log("Flipped:> " + where + " inputs/selects to disabled:" + state)
    }

    $(document).ready(function() {

        // Item click actions
        // Based on the button click, determine which panel to show
        // and update the configtype var
        $('.show').click(function () {
            configtype = $(this).attr('data-target');
            for( var type in { singlenode_panel, multinode_panel, hadoop_panel }) {
                var inner = "#" + type;
                $(inner).hide();
                $(inner + " input").prop('disabled', true);
                $("#webkeyfiles input").prop('disabled', true);
                $("#predictionkeyfiles input").prop('disabled', true);
                $("#remotelogginginfo input").prop('disabled', true);
                $("#smtpconfig input").prop('disabled', true);
                $("#smtpconfig select").prop('disabled', true);
                $("#haconfig input").prop('disabled', true);
                $("#dpsconfig input").prop('disabled', true);

                if ( type.indexOf(configtype) !== -1 ) {
                    $(inner).show();
                    $(inner + " input").prop('disabled', false);
                }   
            }
        });

        // When the check box is checked, do this!
        $("#webserverssl").click(function () { flipit("webkeyfiles"); });
        $("#predictionssl").click(function () { flipit("predictionkeyfiles"); });
        $("#remotelogging").click(function () { flipit("remotelogginginfo"); });
        $("#enablesmpt").click(function () { flipitselect("smtpconfig"); });
        $("#dedicatedpredictionserver").click(function () { flipit("dpsconfig"); });
        $("#enableha").click(function () { flipit("haconfig"); });
        $("#advanced").click(function(e){ $("#advancedoptions").toggle() });

        // Generates the JSON array used to create the yaml file
        // All validation should have been done beofre this fires
        $("#create").click(function(e){
            e.preventDefault();

            var formData = $("#config").serializeJSON();

            if (configtype == "singlenode") {
                $.extend(formData.servers[0].services, singleconfig);
            }
            else if (configtype == "multinode") {

                for( var type in types) {
                    var key = types[type];
                    var services
                    console.log( "type " + type + ":>" + key + "\ntypeof:>" + typeof( formData.servers[key] ) + "\nServices:" + services[ key ] );
                    $.extend(formData.servers[key].services, services[ key ]);
                }
            }

            var yaml = jsyaml.load( JSON.stringify(formData), { 'schema': 'FAILSAFE_SCHEMA' } );
           //var yaml = jsyaml.load( JSON.stringify(formData));

            //console.log(yaml);
            $("#generatedconfig").html( "---\n" + jsyaml.safeDump( yaml ) );
            $("#generatedconfig").show()
        });


        // Drag and Drop functionality
        // Add Sortability
        $( "#nodetype, #node1, #node2, #node3, #node4" ).sortable({
            connectWith: ".connectedSortable"
        }).disableSelection();

        var $nodetype = $( "#nodetype" ),
                $serverlist = $( "#serverlist" );

        // Make the nodetype items be dragable
        console.log( "Divs graggable within nodetype:>" + $( "div.nodeconfig", $nodetype ).length );
        $( "#nodetype" ).draggable({
            revert: "invalid", // when not dropped, the item will revert back to its initial position
            containment: "document",
            helper: "clone",
            cursor: "move"
        });

        // Hide the config elements if dropped back into the nodetype area
        $( "#nodetype" ).droppable({
            drop: function( event, ui) {
                $( ui.draggable ).find(".app_values").hide();
                $( ui.draggable ).removeClass("dropped_config");
            }
        });

        // Let the nodes be droppable, accepting the nodetype items
        $( "#node1, #node2, #node3, #node4" ).droppable({
            drop: function( event, ui) {
                $( ui.draggable ).find(".app_values").show();
                $(ui.draggable).addClass("dropped_config");

                //console.log( $( this ).find(".nodeconfig").length )

                if ($( this ).find(".nodeconfig").length > 1) {
                    console.log("Deactivating app host ip")
                    
                }

                //console.log(this)
            }
        });

        // Adding the onclick for new field functionality
        var maxnodes = 9;
        var mcount = 1;
        var pcount = 1;

        $("#addmodel, #addprediction").click(function(e){
            e.preventDefault();
            nodetype = $(this).attr('data-target');
            var count = ( nodetype == "model" ) ? mcount : pcount;
            if( count < maxnodes){ //max input box allowed
                count++; //text box increment
                $("#" + nodetype + "wrap").append("<div><input type=\"text\" name=\"servers[model][hosts][]\" class=\"defaultinput\" required placeholder=\"IP Address\" pattern=\"^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$\" /><button type='button' class='remove" + nodetype + "'>Remove</button></div>");
            }
            if ( nodetype == "model" ) { mcount = count; } else { pcount = count; }
        });

        $("#modelwrap").on("click",".removemodel", function(e){ //user click on remove text
            e.preventDefault();
            $(this).parent('div').remove(); 
            mcount--;
        })

        $("#predictionwrap").on("click",".removeprediction", function(e){ //user click on remove text
            e.preventDefault();
            $(this).parent('div').remove(); 
            pcount--;
        })        
    });
    </script>

</head>
<body>

    <fieldset>
        <legend><h1>DataRobot Config Builder v 0.1</h1> </legend>
        <p>Use the configuration builder to help you create working DataRobot configuration files to power the installation process!</p>
        
        <form id="config" method="get">
            <div class="panel">
                <div class="question">
                    <label for="username">User name:</label>
                    <input type="text" id="username" name="os_configuration[user]" class="defaultinput" required value="datarobot" pattern="(?=^.{3,20}$)^[a-zA-Z][a-zA-Z0-9]*[._-]?[a-zA-Z0-9]+$" />
                </div>                
                <div class="question">
                    <label for="groupname">Group:</label>
                    <input type="text" id="groupname" name="os_configuration[group]" class="defaultinput" required value="datarobot" pattern="^[A-Za-z0-9]+$" />
                </div>
                <div class="question">
                    <label for="userkey">User key:</label>
                    <input type="text" id="userkey"  name="os_configuration[private_ssh_key_path]" class="pathinput" required value="/home/datarobot/.ssh/id_rsa" />
                </div>
            </div>
            <div class="panel">

                <div class="question">
                    <label for="adminuser">Admin name:</label>
                    <input type="text" id="adminuser" name="os_configuration[admin_user]" class="defaultinput" required value="datarobot"/>
                </div>
                <div class="question">
                    <label for="adminkey">Admin key:</label>
                    <input type="text" id="adminkey" name="os_configuration[admin_private_ssh_key_path]" class="pathinput" required value="/home/datarobot/.ssh/id_rsa"/>
                </div>

            </div>

            <div class="panel">
                <div class="question">
                    <label for="datarobot_home_dir">DataRobot Home Dir:</label>
                    <input type="text" id="datarobot_home_dir" name="os_configuration[datarobot_home_dir]" class="pathinput" required value="/opt/datarobot"/>
                </div>
            </div>

            <div class="panel">
                <button type="button" id="single" class="show" data-target="singlenode">Single Node</button>
                <button type="button" id="multi" class="show" data-target="multinode">Multi Node</button>
                <button type="button" id="hadoop" class="show" data-target="hadoop">Multi Node with Hadoop</button>
                <button type="button" id="advanced" class="advancedbutton" data-target="advancedoptions">Advanced Options</button>
            </div>

            <div id="advancedoptions" class="panel">

                <div class="panel question bundle">
                    ### Miscellaneous
                    VERIFY_SSL: false
                    * **ALLOW_SELF_SIGNED_CERTS** (*False*): Set to `True` to disable SSL certificate verification for requests made by the application to the web server. Set this if you have SSL encryption enabled on your cluster and are using certificates that are not signed by a globally trusted Certificate Authority.
                    * **STREAM_FORMATTER_TYPE** (*json*): Format for DataRobot application logs. Set to `plain` for more human-readable logs. (Note: some components will not respect this setting)
                    * **NEXT_STEPS_WORKERS** (*100*): Number of workers available for queue management per `edaworker` service. You shouldn't need to increase this unless you have a massive number (100's) of projects running in parallel.
                    * **EXTERNAL_WEB_SERVER_URL** : The base url users use to access the webserver, e.g. "https://app.datarobot.com".  Set this variable if it differs from the internally configured hostname, for example if the web server is behind a load balancer.
                </div>                
                
                <div class="panel question bundle">
                    ## Root-level keys
                    The following keys are very rarely used.
                    They should be placed at the root level of the `config.yaml` dictionary (_ie._ zero indentation).
                        
                    * **docker_version** (*17.03.1-ce*): Version of Docker to use. Will break `make bootstrap-cluster` if this version is not installed on all nodes.
                    * **docker_py_version** (*1.3.1*): Version of docker-py library to use for Ansible to control Docker containers. Other versions of docker-py are not supported and may have compatibility issues between Docker and Ansible.
                    * **docker_group_name** (*docker*): Name of the group that `/var/run/docker.sock` is owned by. The DataRobot user will be added to this group by `make bootstrap-cluster` if it is run. Users must be in this group to issue Docker commands.                    
                </div>

                <div class="panel question bundle">
                    ### File upload size
                    These settings determine the maximum file ingest size for your cluster. Note that 11 Gigabytes (the default setting) is a hard upper limit on the amount of data that DataRobot is currently able to process.
                
                    * **MAX_CONTENT_LENGTH** (*11811160064*): Maximum size of file that can be uploaded in bytes.
                    * **MAX_DECOMPRESSED_SIZE** (*5368709120*): Maximum decompressed size of file that can be uploaded in bytes.
                    * **MAX_PREDICTION_CONTENT_LENGTH** (*1073741824*): Maximum size of files for batch predictions in bytes.
                </div>

                <div class="panel question bundle">
                    ### Activity Monitor
                    These settings enable audit logging and activity monitor UI. One shouldn't enable both `AUDIT_LOGS_LOGSTASH_HOST` and `AUDIT_LOGS_USE_API` simultaneously.
                
                    * **AUDIT_LOGS_LOGSTASH_HOST** (*empty*): Hostname of logstash server that accepts audit logs (UDP) for writing them to Mongo and on disk. The application doesn’t send audit logs to logstash if this variable is missing or empty.
                    * **AUDIT_LOGS_LOGSTASH_PORT** (*5544*): Logstash port number listening to audit logs (UDP).
                    * **AUDIT_LOGS_USE_API** (*False*): Save audit logs to Mongo using internal API (TCP).
                </div>                    
                
                <div class="panel question bundle">
                    ### SELinux
                    * **ENABLE_SELINUX** (*False*): Set to `True` to install the application in an SELinux Enforcing environment.
                </div>        

                <div class="panel question bundle">
                    ### AWS access
                    Set these keys if you need to use AWS keys to access S3-based file storage (see `app_configuration.FILE_STORAGE_TYPE`). IAM role-based storage access is not yet available.
                    * **AWS_ACCESS_KEY_ID** : Access key ID for the account you want to use to connect to S3 storage.
                    * **AWS_SECRET_ACCESS_KEY** : Secret access key for authenticating your AWS account.
                    * **S3_BUCKET** : Name of the S3 bucket to store DataRobot application files in. Your access key ID must belong to an account that has write, read, and list permissions on this bucket.
                </div>

                <div class="panel question bundle">
                    ### Queue settings
                    * **JOB_RETRY_IDLE_INTERVAL** (*300*): Number of seconds between job retry service scan iterations.
                    * **JOB_RETRY_MAX_RETRIES** (*10*): Maximum number of retry attempts per job.
                    * **JOB_RETRY_COUNTER_TTL** (*900*): TTL of retry attempts counter (in seconds).
                </div>

                <div class="panel question bundle">
                    ### Worker settings
                    **NOTE** These settings do not affect Hadoop workers.
                    * **SECURE_WORKER_FIT_WORKERS** (*2*): Number of modeling workers to run per `secureworker` container.
                    * **MAX_N_JOBS_MULTIPROCESSING** (*4*): Maximum number of concurrent subprocesses a modeling worker can run.
                    * **MAX_N_JOBS_MULTITHREADING** (*4*): Maximum number of threads a modeling worker can run. Set to a lower number to reduce modeling worker CPU utilization.
                    * **EDA_WORKERS** (*1*): Number of EDA workers to run per `edaworker` container.    
                </div>

                <div class="panel question bundle">
                    ### File storage settings
                    * **FILE_STORAGE_TYPE** (*gluster_api*): For Cloudera installations set to `hdfs` (WebHDFS storage driver) or `hdfs3` (native HDFS storage driver). For Dockerized installations, set to `gluster_api` (Dockerized Gluster storage) or `s3` (AWS S3 storage).
                    * **FILE_STORAGE_PREFIX** : Represents the prefix applied to all paths in the file storage medium after the root path.
                    * **CACHE_LIMIT** (*2147483648*): Maximum size in bytes of the cache directory. The default location of this directory is `/opt/datarobot/data/app_data/cache`. The DataRobot application will remove older files from the cache when it writes data that would otherwise exceed this limit. 
                    **NOTE:** Must be smaller than the free space on the disk at all times.                        
                </div>

                <div class="panel question bundle">
                    ### Log settings
                    * **DEBUG** (*False*): Set to `True` to enable debug logging for `datasetsservice` services.
                    * **LOGGING_LEVELNAME** (*INFO*): Controls log level of main application. Options are DEBUG, INFO, WARN, ERROR.
                </div>

                <div class="panel question bundle">
                    ### Instrumentation settings
                    DataRobot components can optionally have statsd instrumenation enabled for performance monitoring and profiling.
                    * **PROFILE_DEFAULT_ALL** (*False*): Set to `True` when enabling statsd instrumentation.
                    * **PROFILE_USE_STATSD** (*False*): Set to `True` when enabling statsd instrumentation.
                    * **STATSD_ENABLED** (*False*): Set to `True` when enabling statsd instrumentation.
                    * **STATSD_NAME** (*unknown*): Set a custom name for your hosts metrics to identify your cluster.
                    * **STATSD_HOST** : Set to the hostname or IP address of the node you want to send statsd metrics to.
                    * **UWSGI_CARBON** : Set to the hostname or IP address of the Carbon Cache instance to send uwsgi metrics to.
                </div>

                <div class="panel question bundle">
                    <h2>LDAP</h2>
                    * **USER_AUTH_TYPE** (*internal*): Set to `ldap` or `ldapsearch` to enable LDAP authentication integration. `internal` configures DataRobot to use its own authentication system. `ldap` doesn't require a service LDAP user, but it can't be used with some LDAP configurations. `ldapsearch` covers all the uses cases of `ldap`, but it requires a service LDAP user (which can be configured via **USER_AUTH_LDAP_BIND_{DN,PASSWORD}**). Please see [LDAP Auth Deploy / Troubleshoot Guide](https://datarobot.atlassian.net/wiki/pages/viewpage.action?pageId=101744654) for details.
                    * **USER_AUTH_LDAP_URI** : URI of LDAP server Eg. `ldap://1.2.3.4:389`                        * **USER_AUTH_LDAP_REQUIRED_GROUP** : DN of an LDAP group required for accessing DataRobot.
                    * **USER_AUTH_LDAP_DIST_NAME_TEMPLATE** : `ldap` mode - template for LDAP Dist Names. Eg. `mail=$username,cn=users,dc=datarobot,dc=com`.
                    * **USER_AUTH_LDAP_BIND_DN** : `ldapsearch` mode - DN of the service LDAP account.
                    * **USER_AUTH_LDAP_BIND_PASSWORD** : `ldapsearch` mode - PASSWORD of the service LDAP account.
                    * **USER_AUTH_LDAP_SEARCH_BASE_DN** : `ldapsearch` mode - LDAP node that contains all the DR users. Eg. `cn=users,cn=accounts,dc=datarobot,dc=com`.
                    * **USER_AUTH_LDAP_SEARCH_SCOPE** (*SUBTREE*): `ldapsearch` mode - LDAP search scope (`ONELEVEL` or `SUBTREE`).
                    * **USER_AUTH_LDAP_SEARCH_FILTER** (`(cn=$username)`): `ldapsearch` mode - LDAP search query template.
                </div>

                <div class="panel question bundle">
                    <h2>PKI</h2>
                    Set these values to configure authentication via Public Key certificates. Keep in mind that these
                    are just the application configuration variables - in order to enable PKI you will also need
                    to configure the `os_configuration.ssl` variables so that nginx can correctly authenticate clients.
                        
                    * **USER_AUTH_PKI_ENABLED** (*false*): boolean, enables PKI auth
                    * **USER_AUTH_PKI_HEADER_NAME** (*X-Ssl-Client-S-Dn*): string, recommend "X-Ssl-Client-S-Dn".
                      This is the name of the header that nginx will set after authenticating clients. This
                      value must match the value of `os_configuration.ssl.pki_header_name`.
                    * **USER_AUTH_PKI_AUTO_CREATE_ACCOUNT** (*false*): boolean. if enabled, any authenticated
                        client will get a new account created on DataRobot. Otherwise, an admin must
                        create the account before the user can access the system at all.
                    * **USER_AUTH_PKI_MAPPING** List of fields to be copied from the certificate subject to the local
                        DR profile in the format `{local_field_name: subject_field_name}` i.e. `{'username': 'emailAddress', 'display_name': 'CN'}`                       
                </div>
                            
                <div class="panel question bundle">
                    ### Hadoop settings
                    These settings are specific to Hadoop installations.
                        
                    * **ENABLE_HADOOP_DEPLOYMENT** (*False*): Set to `True` to turn on Hadoop-related features.
                    * **SECURE_WORKER_USER_TASK_IMAGE** (*sw-model-v1.0*): Set this to `subprocess` on Hadoop systems.
                        
                </div>

                <div class="panel question bundle">
                    **WARNING:**
                    You should not need to modify the below settings yourself, even if the defaults do not match your system.
                    The installation process should set them appropriately in your containers via the properties file.
                    *Do not modify them unless you know what you are doing*.
                        
                    * **KERBEROS_ENABLE** (*False*): Whether Kerberos authentication is used when connecting to HDFS.
                    * **DATAROBOT_CONFIG** (*/opt/datarobot/etc/hadoop/datarobot-defaults.conf*): The path inside the application container to find the DataRobot properties file. Change this if you want to use an alternative file without modifying the existing file.
                    * **KRB5_CONFIG** (*/opt/datarobot/etc/hadoop/krb5.conf*): The path inside the application containers to find Kerberos settings.
                    * **KERBEROS_KEYTAB_FILE** (*/opt/datarobot/etc/hadoop/datarobot.keytab*): The path inside the application containers to find the Kerberos keytab file.
                    * **KERBEROS_PRINCIPAL** : Name of the Kerberos principal your containers should use for authentication.
                    * **KERBEROS_KINIT_LOCATION** (*/usr/bin/kinit*): The location of the kinit binary in your containers.
                    * **KERBEROS_TGT_LIFETIME** (*86400*): The lifetime of Kerberos tickets.
                    * **WEBHDFS_IS_SECURE** (*False*): Whether WEBHDFS connections are secured by Kerberos authentication.
                    * **WEBHDFS_HOST** : The location of the WEBHDFS host in the form `http://host:port`.
                    * **WEBHDFS_IMPERSONATION_FIELD** : User to impersonate.
                    * **WEBHDFS_IMPERSONATION_FIELD_TO_LOWER** (*True*): Make the value of the impersonation field lowercase.
                    * **WEBHDFS_STORAGE_DIR** : The root of the path used for storing files in HDFS.
                    * **WEBHDFS_DEFAULT_USER** (*datarobot*): The user to impersonate on a cluster not secured by Kerberos.
                    * **YARN_REST_API_HOST** : Location of the YARN REST API host.
                    * **VW_PATH** (*/opt/cloudera/parcels/DataRobot/bin/vw*): Location of the Vowpal Wabbit binary in Cloudera parcels.                        
                </div>
                


<!--

# Extra Configuration Options

## app\_configuration
The following keys can be put in the `app_configuration` section of either the root-level dictionary or a host-specific `app_configuration`.
Key names are in **bold**, followed by their (*default*) settings, followed by a description of the key.
Keys are grouped into logically related sections.

### Queue settings
### Worker settings
### File storage settings
### Log settings

### Instrumentation settings

## drenv\_override
The following keys can be put in the `drenv_override` sub-dictionary of any `app_configuration` dictionary.
This section is not likely to be an exhaustive list of all configuration options available. However, the most relevant will be recorded here.

-->
            </div>

            <div id="singlenode_panel" class="panel hidden">
                <input type="hidden" id="services" name="servers[][services][]" value="" />
                <div class="question">
                    <label for="hostip">Host IP:</label>
                    <input type="text" id="hostip" name="servers[][hosts][]" required placeholder="IP Address" pattern="^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"/>
                </div>
            </div>

            <div id="multinode_panel" class="panel hidden">
                <div class="panel question bundle">
                    <label for="webserverip">Webserver IP:</label>
                    <input type="text" id="webserverip" name="os_configuration[webserver_hostname]" value="1.1.1.1" class="defaultinput" required placeholder="IP Address" pattern="^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$|^$"/>
                    <label for="webserverssl">Enable Webserver SSL?</label>
                    <input type="checkbox" id="webserverssl" name="os_configuration[ssl][enabled]" value="true" />
                    <div id="webkeyfiles" class="hidden">
                        <span>Relative to $datarobot_home_dir/certs/</span>
                        <br />
                        <label for="webserversslcert">Certificate Path:</label>
                        <input type="text" id="webserversslcert" name="os_configuration[ssl][cert_file_name]" class="defaultinput" required placeholder="cert.pem" />
                        <label for="webserversslkey">Key Path:</label>
                        <input type="text" id="webserversslkey" name="os_configuration[ssl][key_file_name]" class="defaultinput" required placeholder="cert.key" />
                        <label for="webservercafilename">CA File Name:</label>
                        <input type="text" id="webservercafilename" name="os_configuration[ssl][ca_file_name]" class="defaultinput" required placeholder="cert.key" />
                        <label for="webserverpkiheadername">PKI Header Name:</label>
                        <input type="text" id="webserverpkiheadername" name="os_configuration[ssl][pki_header_name]" class="defaultinput" required placeholder="cert.key" />
                    </div>
                </div>

                <div class="panel question bundle">
                    <label for="predictionendpoint">Prediction Server:</label>
                    <input type="text" id="predictionendpoint" name="os_configuration[prediction_endpoint]" class="defaultinput" placeholder="IP Address" pattern="^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"/>
                    <label for="predictionssl">Enable Prediction Endpoint SSL?</label>
                    <input type="checkbox" id="predictionssl" name="os_configuration[prediction_ssl][enabled]" value="true" />
                    <div id="predictionkeyfiles" class="hidden">
                        <span>Relative to $datarobot_home_dir/certs/</span>
                        <br />
                        <label for="predictionsslcert">Certificate Path:</label>
                        <input type="text" id="predictionsslcert" name="os_configuration[prediction_ssl][cert_file_name]" class="defaultinput" required placeholder="cert.pem" />
                        <label for="predictionsslkey">Key Path:</label>
                        <input type="text" id="predictionsslkey" name="os_configuration[prediction_ssl][key_file_name]" class="defaultinput" required placeholder="cert.key" />
                        <label for="predictioncafilename">CA File Name:</label>
                        <input type="text" id="predictioncafilename" name="os_configuration[prediction_ssl][ca_file_name]" class="defaultinput" required placeholder="ca_file_name.key" />
                    </div>
                </div>

                <div class="panel question bundle">
                    <label for="secretsenforced" title="Passwords will be generated automatically on `recreate-containers` if not already set.">Enforce Secrets?</label>
                    <input type="checkbox" id="secretsenforced" name="os_configuration[secrets_enforced]" value="true" />
                </div>

                <div class="panel question bundle">
                    <label for="remotelogging">**Enable Remote Logging?</label>
                    <input type="checkbox" id="remotelogging" name="os_configuration[logs][enabled]" value="true" />
                    <div id="remotelogginginfo" class="hidden">
                        <label for="remotelogserver">Log Server:</label>
                        <input type="text" id="remotelogserver" name="os_configuration[logs][server]" class="defaultinput" required placeholder="logstash.example.com" />
                        <br />
                        <label for="remotelogport">Port:</label>
                        <input type="port" id="remotelogport" name="os_configuration[logs][port]" required placeholder="5544" pattern="\d{3,6}" />
                    </div>
                </div>

                <div id="nodetype" class="connectedSortable panel">
                    <div id="app_config" class="nodeconfig">Application Node
                        <div class="app_values hidden">
                            <input type="hidden" id="services" name="servers[app][services][]" value="" />
                            
                            <label for="apphostip">Host IP:</label>
                            <input type="text" id="apphostip" name="servers[app][hosts][]" value="1.1.1.1" class="defaultinput" required placeholder="IP Address" pattern="^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"/>
                            <br />                        
                            <label for="enablesmpt">Enable SMTP?</label>
                            <input type="checkbox" id="enablesmpt"/>

                            <div id="smtpconfig" class="hidden">
                                <label for="smtpaddress">SMTP Host:</label>
                                <input type="text" id="smtpaddress" name="servers[app][app_configuration][drenv_override][SMTP_ADDRESS]" class="defaultinput" required placeholder="smtp.gmail.com" />
                                <br />
                                <label for="smtpport">SMTP Port:</label>
                                <input type="port" id="smtpport" name="servers[app][app_configuration][drenv_override][SMTP_PORT]" required placeholder="587" pattern="\d{3,6}" />
                                <br />
                                <label for="smtpmode">SMTP Mode:</label>
                                <select id="smtpmode" name="servers[app][app_configuration][drenv_override][SMTP_MODE]" required>
                                    <option value="SMTP_STARTTLS">Start TLS (default)</option>
                                    <option value="SMTP">Standard SMTP</option>
                                    <option value="SMTP_SSL">SSL</option>
                                </select>
                                <br />                              
                                <label for="smtpuser">Username:</label>
                                <input type="email" id="smtpuser" name="servers[app][app_configuration][drenv_override][SMTP_USER]" required placeholder="snmp_user@example.com" />
                                <label for="smtppassword">Password:</label>
                                <input type="password" id="smtppassword" name="servers[app][app_configuration][drenv_override][SMTP_PASSWORD]" required />
                                <br />
                                <label for="smtphtmlemail">Send HTML email?</label>
                                <input type="checkbox" id="smtphtmlemail" name="servers[app][app_configuration][drenv_override][HTML_EMAILS_ENABLED]" value="true" checked />
                                <br />
                                <label for="smtpmode">Enable TLS Mode?</label>
                                <input type="checkbox" id="smtpmode" name="servers[app][app_configuration][drenv_override][SMTP_MODE]" value="SMTP_STARTTLS" />
                                <br />
                                <label for="defaultsender">Default Sender:</label>
                                <input type="email" id="defaultsender" name="servers[app][app_configuration][drenv_override][DEFAULT_SENDER]" placeholder="support@example.com" />
                                <label for="defaultapprover">Default Approver:</label>
                                <input type="email" id="defaultapprover" name="servers[app][app_configuration][drenv_override][DEFAULT_APPROVER]" placeholder="support@example.com" />
                                <label for="defaultcfdsreceiver">New Users:</label>
                                <input type="email" id="defaultcfdsreceiver" name="servers[app][app_configuration][drenv_override][DEFAULT_CFDS_RECEIVER]" placeholder="cfds@example.com" />
                                <label for="defaultsupport">Default Support:</label>
                                <input type="email" id="defaultcfdsreceiver" name="servers[app][app_configuration][drenv_override][DEFAULT_SUPPORT]" placeholder="support@example.com" />
                                <label for="contractsemail">Contracts Email:</label>
                                <input type="email" id="contractsemail" name="servers[app][app_configuration][drenv_override][CONTRACTS_EMAIL]" placeholder="cfds@example.com" />
                            </div>
                        </div>
                    </div>

                    <div id="data_config" class="nodeconfig">Data Node

                        <div class="app_values hidden">
                            <input type="hidden" id="services" name="servers[data][services][]" value="" />
                            <label for="datahostip">Host IP:</label>
                            <input type="text" id="datahostip" name="servers[data][hosts][]" value="1.1.1.1" class="defaultinput" required placeholder="IP Address" pattern="^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"/>
                            <br />
                            <label for="enableha">Enable HA?</label>
                            <input type="checkbox" id="enableha"/>
        
                            <div id="haconfig" class="hidden">
                                <label for="haaddress1">HA Host 1:</label>
                                <input type="text" id="haaddress1" name="servers[data][hosts][]" class="defaultinput" required placeholder="IP Address" pattern="^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$" />
                                <br />
                                <label for="haaddress1">HA Host 2:</label>
                                <input type="text" id="haaddress1" name="servers[data][hosts][]" class="defaultinput" required placeholder="IP Address" pattern="^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$" />
                                <br />
                            </div>
                        </div>
                    </div>

                    <div id="modeling_config" class="nodeconfig">Modeling Node
                        <div class="app_values hidden">
                            <input type="hidden" id="services" name="servers[model][services][]" value="" />
                            <div id="modelwrap" class="input_fields_wrap">
                                <button type="button" id="addmodel" class="add_field_button" data-target="model" >Add Modeler IP</button>
                                <div><input type="text" name="servers[model][hosts][]" value="1.1.1.2" class="defaultinput" required placeholder="IP Address" pattern="^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$" /></div>
                            </div>
                        </div>
                    </div>

                    <div id="prediction_config" class="nodeconfig">Prediction Node
                        <div class="app_values hidden">
                            <input type="hidden" id="services" name="servers[prediction][services][]" value="" />

                            <div id="predictionwrap" class="input_fields_wrap">
                                <button type="button" id="addprediction" class="add_field_button" data-target="prediction" >Add Prediction IP</button>
                                <div><input type="text" name="servers[prediction][hosts][]" value="1.1.1.1" class="defaultinput" required placeholder="IP Address" pattern="^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$" /></div>
                            </div>
                            <label for="dedicatedpredictionserver">Dedicated Prediction Server?</label>
                            <input type="checkbox" id="dedicatedpredictionserver" name="servers[prediction][app_configuration][drenv_override][dedicated_prediction_server]" value="true"/>
                            <div id="dpsconfig" class="hidden">
                                <label for="workermodelcache">Worker Cache:</label>
                                <input type="text" id="workermodelcache" name="servers[prediction][app_configuration][drenv_override][WORKER_MODEL_CACHE]" class="defaultinput" required placeholder="smtp.gmail.com" />

                                <label for="modelcachemode">Cache Mode:</label>
                                LRU <input type="radio" id="modelcachemode" name="servers[prediction][app_configuration][drenv_override][MODEL_CACHE_MODE]" value="LRU" checked />
                                <input type="radio" id="modelcachemode" name="servers[prediction][app_configuration][drenv_override][MODEL_CACHE_MODE]" value="latest" />Latest
                                <br />
                                <label for="cachedbresult">Cache Result:</label>
                                <input type="checkbox" id="cachedbresult" name="servers[prediction][app_configuration][drenv_override][CACHE_DB_RESULT]" value="true"/>
                             </div>
                        </div>
                    </div>
                </div>

                <div id="serverlist" class="panel">
                    <div id="node1" class="connectedSortable">
                        

                        <div class="nodehost hidden">
                            <label for="node1hostip">Host IP:</label>
                            <input type="text" id="node1hostip" name="servers[][hosts][]" value="1.1.1.1" class="defaultinput" required placeholder="IP Address" pattern="^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"/>
                        </div>

                    </div>


                    <div id="node2" class="connectedSortable"></div>
                    <div id="node3" class="connectedSortable"></div>
                    <div id="node4" class="connectedSortable"></div>
                </div>
    
            </div>

            <div id="hadoop_panel" class="panel hidden">Hadoop node data goes here!</div>

            <!-- <div class="createbutton"><button type="submit" id="create">Create</button></div> -->
            <div class="createbutton"><button id="create">Create</button></div>
            <div class="resetbutton"><button type="reset" id="reset" >Reset</button></div>
        </form>

    </fieldset>

    <fieldset>
        <legend><h1>Generated Config</h1> </legend>
        <div class="display">
            <div class="config">
                <div class="generatedconfig">
                    <textarea id="generatedconfig"></textarea>
                </div>
            </div>
        </div>
    </fieldset>
</body>
</html>